metadata:
  title: Login via UI
  description: |
    Sign in using staff credentials and confirm landing on the dashboard with nav links.
  tags:
    - auth
    - smoke
config:
  browser: chromium
  headless: true
  baseUrl: "{{environment.baseUrl}}"
steps:
  - evaluate:
      script: |
        () => {
          try { localStorage.removeItem('teks-auth'); } catch {}
          return 'true';
        }
  - navigate: "{{config.baseUrl}}/login"
  - waitFor:
      selector: 'input[formcontrolname="username"]'
  - fill:
      selector: 'input[formcontrolname="username"]'
      value: '{{secrets.username}}'
  - fill:
      selector: 'input[formcontrolname="password"]'
      value: '{{secrets.password}}'
  - click:
      selector: 'button[type="submit"]'
  - waitFor:
      selector: 'h1'
      text: 'Texas TEKS Program Manager'
  - expectVisible:
      selector: 'nav a'
      text: 'Students'
  - screenshot:
      name: 'after-login'
      fullPage: true
